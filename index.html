<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ãŠè©±ã®æ£® | mofinaproject</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <main class="screen">
    <section class="panel">
      <header class="banner">
        <h1>ğŸŒ¿ ãŠè©±ã®æ£®ã¸ã‚ˆã†ã“ã</h1>
        <p>ã‚‚ãµãƒãªã¨ã€ãŠè©±ã§ãã‚‹å ´æ‰€ã§ã™ã€‚</p>
      </header>
      <div id="chatLog" class="chatLog"></div>
      <form id="chatForm" class="chatForm" onsubmit="return false;">
        <input id="chatInput" class="chatInput" type="text" placeholder="ã‚‚ãµãƒãªã«è©±ã—ã‹ã‘ã¦ã­â€¦" autocomplete="off" />
        <button id="chatBtn" class="chatBtn" type="submit">é€ä¿¡</button>
      </form>
    </section>
  </main>

<script>
const log = document.getElementById("chatLog");
const input = document.getElementById("chatInput");
const form = document.getElementById("chatForm");

function add(role, text) {
  const row = document.createElement("div");
  row.className = "msg " + (role === "user" ? "user" : "bot");
  row.innerHTML = `<div class="bubble">${text}</div>`;
  log.appendChild(row);
  log.scrollTop = log.scrollHeight;
  return row;
}

form.addEventListener("submit", async () => {
  const message = input.value.trim();
  if(!message) return;
  input.value = "";
  
  add("user", message);
  const thinking = add("bot", "â€¦ï¼ˆã‚‚ãµãƒãªãŒè€ƒãˆã¦ã‚‹ã‚ˆğŸƒï¼‰");

  const res = await fetch("/api/chat", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ message })
  });
  
  const data = await res.json();
  thinking.querySelector(".bubble").textContent = data.reply;
  log.scrollTop = log.scrollHeight; // ãŠè¿”äº‹ãŒå…¥ã£ãŸå¾Œã«ã‚‚ã†ä¸€åº¦ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼
});
</script>
</body>
</html>
